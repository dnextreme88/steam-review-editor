"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function convertHTML(e){var t=e.replace(/<p>/g,"").replace(/<\/p>/g,"\n").replace(/<strong>/g,"[b]").replace(/<\/strong>/g,"[/b]").replace(/<h1>/g,"[h1]").replace(/<\/h1>/g,"[/h1]\n").replace(/<em>/g,"[i]").replace(/<\/em>/g,"[/i]").replace(/<u>/g,"[u]").replace(/<\/u>/g,"[/u]").replace(/<ol>/g,"[olist]\n").replace(/<\/ol>/g,"[/olist]\n").replace(/<ul>/g,"[list]\n").replace(/<\/ul>/g,"[/list]\n").replace(/<li>/g,"[*]").replace(/<\/li>/g,"\n").replace(/<br>/g,"\n").replace(/<a href="/g,"[url=").replace(/" target="_blank">/g,"]").replace(/<\/a>/g,"[/url]").replace(/<s>/g,"[strike]").replace(/<\/s>/g,"[/strike]").replace(/<blockquote>/g,"[quote=author]").replace(/<\/blockquote>/g,"[/quote]\n").replace(/<span class="spoiler">/g,"[spoiler]").replace(/<\/span>/g,"[/spoiler]").replace(/<pre spellcheck="false">/g,"[code]").replace(/<\/pre>/g,"[/code]\n").replace(/<code>/g,"[noparse]").replace(/<\/code>/g,"[/noparse]");$("#markup").html(t),$("#preview").html(e)}function CopyToClipboard(e){var t=document.createElement("textarea");t.id="t",t.style.height=0,document.body.appendChild(t),t.value=document.getElementById(e).innerText,document.querySelector("#t").select(),document.execCommand("copy"),document.body.removeChild(t),alert("Markup copied to clipboard!")}function pushFooter(){var e=$(window).height(),t=$("#footer").height(),n=$("#footer").position().top+t;n<e&&$("#footer").css("margin-top",e-n+10+"px")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),_get=function e(t,n,o){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(r===undefined){var l=Object.getPrototypeOf(t);return null===l?undefined:e(l,n,o)}if("value"in r)return r.value;var a=r.get;return a===undefined?undefined:a.call(o)},Embed=Quill["import"]("blots/embed"),Spoiler=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,null,[{key:"create",value:function(e){var n=_get(t.__proto__||Object.getPrototypeOf(t),"create",this).call(this,e);return n.innerHTML=e,n}}]),t}(Embed);Spoiler.blotName="span",Spoiler.className="spoiler",Spoiler.tagName="span";var steamSpoiler=function(){var e=document.createElement("span"),t=quill.getSelection();t&&quill.insertEmbed(t.index,"span",e)};Quill.register({"formats/spoiler":Spoiler});var quill=new Quill("#editor",{modules:{toolbar:{container:"#toolbar",handlers:{spoiler:steamSpoiler}}},placeholder:"Write your review here!",theme:"snow"}),text=quill.container.firstChild.innerHTML;$('[data-toggle="tooltip"]').tooltip(),quill.on("selection-change",function(e){text=quill.container.firstChild.innerHTML,convertHTML(text),e?$("#editorWindow").addClass("active"):$("#editorWindow").removeClass("active")}),quill.on("text-change",function(){text=quill.container.firstChild.innerHTML,convertHTML(text)}),$("#previewCollapse").on("show.bs.collapse",function(){quill.blur(),console.log(text),document.getElementById("showBtn").innerHTML="Hide Preview"}),$("#previewCollapse").on("hide.bs.collapse",function(){document.getElementById("showBtn").innerHTML="Show Preview",quill.focus()}),$("#closeBtn").click(function(){$("#help").fadeOut(1e3,function(){pushFooter()})});var change=new Delta;quill.on("text-change",function(e){change=change.compose(e)}),setInterval(function(){change.length()>0&&(console.log("Saving changes",change),change=new Delta)},5e3),window.onbeforeunload=function(){if(change.length()>0)return"There are unsaved changes. Are you sure you want to leave?"},$(document).ready(function(){pushFooter();var e=$(".fade");e.css({opacity:"0"}),e.fadeTo(500,1,"swing")});